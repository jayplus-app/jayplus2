# JayPlus

## Table of Contents

1. [Introduction](#Introduction)
2. [Version 1.0 Development Plan](#Version-1.0-Development-Plan)
   - [Frontend Development](#Frontend-Development)
   - [Backend Development](#Backend-Development)
   - [Integration](#Integration)
3. [Features](#Features)
   - [Customer Booking](#Customer-Booking)
   - [Admin Panel](#Admin-Panel)
4. [Frontend App](#Frontend-App)
   - [Customer App](#Customer-App)
   - [Admin App](#Admin-App)
5. [Backend App](#Backend-App)
   - [Services](#Services)
   - [Database](#Database)

## Introduction

### General Overview

JayPlus is a specialized business management platform aimed at auto detailing enterprises. It provides a comprehensive suite of administrative and operational tools, including but not limited to financial management, appointment scheduling, staff management, and more.

### Primary Goals

- Streamlining operational procedures
- Maximizing profit margins
- Facilitating data-driven managerial decisions

### Features in Development

- Scheduling and reservation functionality
- Business analytics and reporting
- Workforce management tools
- Marketing resource kits

## Version 1.0 Development Plan

### General Overview

The initial release, JayPlus v1.0, will mainly focus on implementing the reservation and scheduling subsystem, which will include a user interface for customers and an administrative dashboard.

### Technical Architecture

- Backend: Service-oriented monolithic architecture
- Frontend: Independently deployed client applications

#### Frontend Development

The frontend is engineered using React and TypeScript. It comprises two distinct applications:

- Admin Interface: Primarily focuses on functionalities required by auto detailing administrators, such as reservation management, analytics, and workforce management.
- Customer Interface: Primarily focuses on providing customers with appointment scheduling capabilities.

Technologies Utilized:

- React Framework
- TypeScript Programming Language
- React Router DOM for navigation

#### Backend Development

The backend is implemented in Go, and it is organized into domain-specific microservices. A Postgres database is used for data storage. The following services are the focus for v1.0:

- Scheduling and Reservation
- Payment Gateway
- User Authentication
- Messaging Service
- Database Operations

Technologies Utilized:

- Go Programming Language
- Postgres Database

#### Integration

- REST API endpoints for communication between frontend and backend.
- JWT for secure authorization and authentication.

### Features

#### Customer Booking

Customers can access the booking page at `{business_name}.jayplus.app/booking` where they are guided through a 3-step booking process:

1. **Vehicle Type Selection**
2. **Service Type Selection**
3. **Date and Time Selection**

Upon successful selection, customers are redirected to the payment page where the following are displayed:

- Invoice
- Payment Form

If the payment is successful, a final receipt containing the booking details and payment confirmation number is presented.

##### Booking Process

###### Vehicle Type Selection

- **Vehicle Types Dropdown**:
  - Displays all the vehicle types that {business_name} Auto Detailing services.
- **Description Field**:
  - Provides a description for the selected vehicle type, explaining what types of vehicles it includes.

Example: {Sedan, SUV, LargeSUV/Truck, Motorcycle}
"Any 5-seater sedan, any hatchback, any two-door or mini car."

###### Service Type Selection

- **Service Types Dropdown**:
  - Lists all the service types {business_name} Auto Detailing offers for the selected vehicle.
- **Description Field**:
  - Elaborates on the selected service type, detailing what it entails.

Example: {Show Room, Basic, Interior, Exterior}
"Includes vacuuming (including trunk), washing all rubber mats, wiping the dashboard, power washing the body and windows, and cleaning wheel wells."

###### Date and Time Selection

- **Calendar View**:
  - Displays a 3-day range with navigation buttons to move between dates. Each column represents a day and each cell a timeslot.
- **Active and Inactive Cells**:
  - Active cells indicate available time blocks for booking the selected service and vehicle. Inactive cells signify unavailable time blocks.

###### Business Rules

- Each vehicle type has a set of services available for booking.
- An active cell signifies an available time slot, while an inactive one indicates unavailability for the selected service and vehicle.

#### Payment Page

##### Invoice

A card-styled invoice detailing the booking for which the customer is going to pay. It includes information like date and time, booking number, and more.

##### Payment Form

Utilizes a Stripe-based form for payment processing, accompanied by a phone number field for customer identification.

### Admin Panel

#### Dashboard

Admins can visit `{business_name}.jayplus.app/admin/dashboard` to manage bookings. The dashboard is designed with a sidebar for navigation and a main area displaying the active feature. For V1.0, the only active feature is "Booking Management."

#### Sidebar

- **Business Logo**: Represents the business visually.
- **Admin Features List**: For V1.0, only "Booking Management" is active.
- **Logout Button**: Allows admins to securely log out.

#### Booking Management Page

Accessible at `{business_name}.jayplus.app/admin/booking-management`, this page lets admins view and manage current bookings.

##### Page Elements

- **Page Title**: Clearly identifies the page.
- **"Add a Booking" Button**: Allows manual booking addition.

##### Calendar View

Displays bookings in a calendar layout, showing a 3-day view for mobile and a 5-day view for desktops.

- **Column Headers**: Show the date.
- **Cells**: Display booking details such as start time, vehicle type, and service type.
- **Navigation Buttons**: Allow for date navigation.
- **"Today" Button**: Resets the calendar to the current date.

##### Booking Details Modal

Pops up upon selecting a booking, displaying detailed information and a "Cancel Booking" button.

##### Confirm Delete Modal

Appears upon clicking "Cancel Booking," requiring confirmation for the action.

##### Business Rules

- Admins can add bookings without payment.
- For bookings with payment, admins must use the regular customer portal.
- Selecting "No" in the confirm delete modal reinstates the previous booking details modal.

# Frontend App

## Structure

The frontend application utilizes React and is orchestrated with react-router-dom v6 to manage routing. The application is divided into two distinct sections:

- CustomerApp
- AdminApp

Each of these sections contains an `{Outlet}` tag responsible for rendering the relevant child components depending on the current route.

The codebase adheres to a clean and logical folder structure, which is organized as follows:

- `src`: The source directory
  - `admin`: Contains the Admin app-specific components and utilities
  - `customer`: Contains the Customer app-specific components and utilities
  - `shared`: Houses components and utilities that are common across both apps
  - `utils`: Utility functions used across the project
  - `context`: Handles global state for both apps using ContextAPI

## Customer App

The `CustomerApp` serves as the parent component for the customer-facing side of the application. It dynamically renders child components based on the active route.

### Pages

The `pages` directory under `customer` adopts a domain-driven sub-directory structure. As of version V1.0, it includes:

- `booking`
  - `BookingSelectionPage`: Handles booking options
- `payment`
  - `PaymentPage`: Manages payment process
  - `PaymentSuccessPage`: Displays payment success message

### Components

Components can either be app-specific or shared between both CustomerApp and AdminApp.

#### Customer-Specific

_Note: Details for customer-specific components are pending._

#### Shared

Components that are shared across both applications are stored in the `shared` directory, including:

- `SelectListInline`
- `SelectListItem`
- `DescriptionField`
- `TimeSelectionCalendarView`
  - `PreviousDayButton`
  - `NextDayButton`
  - `DayColumnList`
  - `DayColumn`
- `ButtonMD`
- `KeyValueTable`
- `PaymentForm`
- `ButtonSM`
- `CalendarCell`
- `ButtonXS`

##### Modals

- `BookingDetailsModal`
- `ConfirmCancelModal`

### Routes

Routing is managed in the `routes.tsx` file under the `src` directory. The CustomerApp routes are structured as follows:

- `/`: Root that renders `CustomerApp`
  - `''`: Default route rendering `BookingSelectionPage`
  - `'payment'`: Renders `PaymentPage`
  - `'payment-success'`: Renders `PaymentSuccessPage`

## Admin App

The `AdminApp` is the parent component for the administrative side of the application, and similar to `CustomerApp`, it dynamically renders child components based on the current active route.

### Pages

Contained in the `pages` directory under `admin`, it includes:

- `DashboardPage`: The main administrative dashboard
- `BookingManagementPage`: Manages bookings

### Components

#### Admin-Specific

- `NavbarSide`: Side navigation bar for admin panel
- `NavbarTop`: Top navigation bar for admin panel

### Routes

Routing for AdminApp in `routes.tsx` is as follows:

- `/admin`: Renders `AdminApp`
  - `''`: Default route rendering `DashboardPage`
  - `'booking-management'`: Renders `BookingManagementPage`

# Backend App

## Overview

The backend application is structured in a modular architecture and follows a domain-driven design pattern. The entry point for the backend application is the `main` function located in the `cmd/app` directory.

## Structure

- **Entry Point**: The application's main function resides in the "cmd/app" directory.
- **Core Packages**: The "internal" directory contains service-specific folders.
  - The "app" package acts as a container for these services.
- **Additional Directories**:
  - **utils**: Shared utility functions.
  - **models**: Database models.
  - **contracts**: Interfaces, organized by service.
  - **config**: General app configuration.

## Dependencies

- **Databases**: [Managed Postgres database by digital ocean]
- **Libraries**: Utilizes JWT for authentication, Stripe for payment, and Twilio for SMS.

## Services

### Core Services

#### App Service

- **Responsibility**: Router setup and UI configuration management.
- **Endpoints**:
  - `POST "/ui-config" ({sub-domain})`
- **Handlers**:
  - **UIConfig**: Retrieves business UI settings from the database.

#### DB Service

- **Responsibility**: Manages all database-related activities.

#### Auth Service

- **Responsibility**: Manages authentication and authorization.
- **Endpoints**:
  - `POST "/auth/login" ({email}, {password})`
  - `GET "/auth/logout"`
  - `GET "/auth/refresh"`
- **Handlers**:
  - **Login**: Authenticates user.
  - **Logout**: Logs out user.
  - **RefreshToken**: Refreshes authentication token.

### Business Logic Services

#### Booking Management Service

- **Responsibility**: Handles booking-related business logic.
- **Endpoints**:
  - `POST "/booking-management/vehicle-types" ({sub-domain})`
  - `POST "/booking-management/service-types" ({sub-domain})`
  - `POST "/booking-management/available-timeslots" ({sub-domain}, {vehicle-type}, {service-type})`
  - `POST "/booking-management/service-cost" ({sub-domain}, {vehicle-type}, {service-type})`
  - `POST "/booking-management/create-booking" ({sub-domain}, {vehicle-type}, {service-type}, {payment-number}, {booking-number})`
- **Handlers**:
  - **VehicleTypes**: Retrieves vehicle types.
  - **ServiceTypes**: Retrieves service types.
  - **AvailableTimeslots**: Retrieves available times.
  - **ServiceCost**: Provides cost details.
  - **CreateBooking**: Creates a new booking.
- **Internal Functions**:
  - **UpdateBookingPaymentStatus**: Updates payment status.
  - **DeleteBooking**: Deletes a booking.

#### Payment Service

- **Responsibility**: Handles payment processing.
- **Endpoints**:
  - `POST "/payment/pay-booking" ({booking-number})`
- **Handlers**:
  - **PayBooking**: Processes the booking payment.

### Utility Services

#### SMS Service

- **Responsibility**: Handles SMS functionalities.
- **Internal Functions**:
  - **SendSMS**: Sends SMS to recipients.

## Database

- **Placeholder**: [Include your database schema here]

## Error Handling

- **Placeholder**: [Include common errors and their solutions here]
